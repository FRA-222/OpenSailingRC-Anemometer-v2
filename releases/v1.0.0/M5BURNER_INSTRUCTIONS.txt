# üì± Instructions M5Burner - OpenSailingRC Anemometer v2

**Version** : 1.0.0  
**Plateforme** : M5Stack AtomS3  
**Firmware** : ESP32-S3

---

## üéØ Installation Rapide (3 minutes)

### **Ce dont vous avez besoin**
- M5Burner install√© ([t√©l√©charger ici](https://docs.m5stack.com/en/download))
- M5Stack AtomS3
- C√¢ble USB-C
- Le fichier `OpenSailingRC_Anemometer_v1.0.0_MERGED.bin`

---

## üìã Instructions D√©taill√©es

### **√âtape 1 : Pr√©parer M5Burner**

1. **T√©l√©charger M5Burner** si pas encore install√© :
   - Windows : https://docs.m5stack.com/en/download
   - macOS : https://docs.m5stack.com/en/download
   - Linux : https://docs.m5stack.com/en/download

2. **Installer les drivers USB** (si n√©cessaire) :
   - M5Stack AtomS3 utilise le chip CH9102
   - T√©l√©charger : https://docs.m5stack.com/en/download
   - Red√©marrer l'ordinateur apr√®s installation

3. **Lancer M5Burner**

---

### **√âtape 2 : Connecter l'AtomS3**

1. **Connecter l'AtomS3** √† votre ordinateur avec le c√¢ble USB-C

2. **V√©rifier la connexion** :
   - Windows : Ouvrir Gestionnaire de p√©riph√©riques ‚Üí Ports COM
   - macOS : Ouvrir Terminal ‚Üí `ls /dev/cu.usb*`
   - Linux : `ls /dev/ttyUSB*`

3. **Noter le port s√©rie** (ex: COM3, /dev/cu.usbserial-XXXX, /dev/ttyUSB0)

---

### **√âtape 3 : Configurer M5Burner**

1. **Ouvrir M5Burner**

2. **Aller dans "Custom Firmware"** (en haut de la fen√™tre)

3. **Cliquer sur "Browse"** (bouton parcourir)

4. **S√©lectionner** le fichier :
   ```
   OpenSailingRC_Anemometer_v1.0.0_MERGED.bin
   ```

5. ‚ö†Ô∏è **IMPORTANT - Changer l'adresse de flash** :
   - Par d√©faut, M5Burner affiche : `0x10000`
   - **VOUS DEVEZ CHANGER** √† : **`0x0`**
   - ‚ùå Si vous laissez 0x10000 ‚Üí L'AtomS3 rebootera en boucle
   - ‚úÖ Avec 0x0 ‚Üí Tout fonctionne parfaitement

6. ‚úÖ **Cocher "Erase Flash"**
   - Cette option efface compl√®tement la m√©moire flash
   - Recommand√© pour √©viter les conflits

7. **S√©lectionner le port s√©rie**
   - Choisir le port COM/USB d√©tect√© √† l'√©tape 2

8. **Configurer le baud rate** (optionnel)
   - Valeur recommand√©e : **115200** (par d√©faut)
   - Pour un flash plus rapide : **460800** ou **921600**

---

### **√âtape 4 : Flasher le Firmware**

1. **Cliquer sur "BURN"**

2. **Attendre la progression** :
   ```
   Connecting...
   Writing at 0x00000000... (X %)
   ...
   Hash of data verified.
   ```

3. **Temps d'installation** : ~30 secondes √† 1 minute

4. **Fin du flash** :
   ```
   ‚úÖ Writing at 0x000XXXXX... (100 %)
   ‚úÖ Hash of data verified.
   ```

---

### **√âtape 5 : V√©rification**

1. **L'AtomS3 red√©marre automatiquement**

2. **LED RGB** devrait afficher :
   - **Rouge** : D√©marrage
   - **Bleu** : Mode configuration WiFi
   - **Vert** : Fonctionnement normal

3. **Test de fonctionnement** :
   - Appuyer sur le bouton de l'AtomS3
   - La LED devrait changer de couleur
   - L'an√©mom√®tre devrait commencer √† mesurer

---

## üîß Configuration WiFi (Premi√®re Utilisation)

### **Mode Configuration WiFi Manager**

1. **Au premier d√©marrage**, l'AtomS3 cr√©e un point d'acc√®s WiFi :
   - **SSID** : `OpenSailingRC-Anemometer-XXXXXX`
   - **Pas de mot de passe**

2. **Se connecter au WiFi** de l'AtomS3 depuis votre smartphone/ordinateur

3. **Ouvrir un navigateur** et aller √† :
   ```
   http://192.168.4.1
   ```

4. **Configurer le WiFi** :
   - S√©lectionner votre r√©seau WiFi
   - Entrer le mot de passe
   - Cliquer "Save"

5. **L'AtomS3 red√©marre** et se connecte √† votre r√©seau

---

## ‚ö†Ô∏è D√©pannage

### **Probl√®me : "No serial data received"**

**Causes possibles** :
- C√¢ble USB d√©fectueux ou "charge only"
- Drivers CH9102 non install√©s
- Port s√©rie incorrect
- AtomS3 non en mode flash

**Solutions** :
1. Essayer un autre c√¢ble USB-C (avec donn√©es)
2. Installer les drivers CH9102
3. V√©rifier le port s√©rie dans M5Burner
4. Maintenir le bouton de l'AtomS3 pendant la connexion

---

### **Probl√®me : AtomS3 reboot en boucle apr√®s flash**

**Cause** : Adresse de flash incorrecte (0x10000 au lieu de 0x0)

**Solution** :
1. Re-flasher avec M5Burner
2. ‚ö†Ô∏è **V√©rifier que l'adresse est bien 0x0**
3. ‚úÖ Cocher "Erase Flash"
4. BURN

---

### **Probl√®me : "Hash of data does not match"**

**Cause** : Fichier corrompu ou transfert interrompu

**Solutions** :
1. Re-t√©l√©charger le fichier MERGED.bin
2. V√©rifier l'int√©grit√© avec SHA256 :
   ```bash
   shasum -a 256 OpenSailingRC_Anemometer_v1.0.0_MERGED.bin
   ```
3. Re-flasher

---

### **Probl√®me : M5Burner ne d√©tecte pas l'AtomS3**

**Solutions** :
1. **Windows** :
   - V√©rifier dans Gestionnaire de p√©riph√©riques
   - Installer manuellement les drivers CH9102

2. **macOS** :
   - Donner les permissions syst√®me √† M5Burner
   - Syst√®me ‚Üí Confidentialit√© ‚Üí Acc√®s complet au disque

3. **Linux** :
   - Ajouter votre utilisateur au groupe `dialout` :
     ```bash
     sudo usermod -a -G dialout $USER
     ```
   - Red√©marrer

---

### **Probl√®me : LED reste rouge apr√®s flash**

**Causes possibles** :
- Bootloader manquant
- Flash incompl√®te
- Erreur mat√©rielle

**Solutions** :
1. Effacer compl√®tement la flash :
   ```bash
   python3 -m esptool --chip esp32s3 --port PORT erase_flash
   ```

2. Re-flasher le MERGED.bin √† 0x0

3. Si le probl√®me persiste, contacter le support

---

## üìä R√©sum√© Configuration

| Param√®tre | Valeur |
|-----------|--------|
| **Fichier** | OpenSailingRC_Anemometer_v1.0.0_MERGED.bin |
| **Adresse** | **0x0** ‚ö†Ô∏è (PAS 0x10000) |
| **Erase Flash** | ‚úÖ OUI |
| **Baud Rate** | 115200 (recommand√©) |
| **Chip** | ESP32-S3 |
| **Taille Flash** | 8 MB |

---

## ‚ö° Flash Rapide (R√©sum√©)

```
1. M5Burner ‚Üí Custom Firmware
2. Browse ‚Üí MERGED.bin
3. Adresse: 0x0 ‚ö†Ô∏è
4. Erase Flash: ‚úÖ
5. Port: COM/USB
6. BURN
7. Attendre ~1 minute
8. ‚úÖ Termin√©!
```

---

## üìö Alternative : ESPTool (Ligne de Commande)

Si vous pr√©f√©rez la ligne de commande :

```bash
# Flash du firmware fusionn√©
python3 -m esptool --chip esp32s3 \
    --port /dev/cu.usbserial-XXXXXXXX \
    --baud 115200 \
    write_flash -z \
    --flash_mode dio \
    --flash_freq 80m \
    --flash_size 8MB \
    0x0 OpenSailingRC_Anemometer_v1.0.0_MERGED.bin
```

Ou avec les fichiers s√©par√©s :

```bash
python3 -m esptool --chip esp32s3 \
    --port /dev/cu.usbserial-XXXXXXXX \
    --baud 115200 \
    write_flash -z \
    --flash_mode dio \
    --flash_freq 80m \
    --flash_size 8MB \
    0x0 bootloader.bin \
    0x8000 partitions.bin \
    0x10000 firmware.bin
```

---

## üìû Support

**Documentation** : `releases/v1.0.0/RELEASE_NOTES.md`  
**GitHub Issues** : https://github.com/votre-repo/issues  
**Email** : support@opensailingrc.org

---

## ‚úÖ Checklist de V√©rification

Avant de consid√©rer l'installation comme r√©ussie :

- [ ] AtomS3 red√©marre sans reboot infini
- [ ] LED RGB s'allume (rouge/bleu/vert)
- [ ] Bouton r√©pond (changement couleur LED)
- [ ] WiFi Manager accessible (192.168.4.1)
- [ ] An√©mom√®tre mesure les donn√©es (v√©rifier avec moniteur s√©rie)

---

**Version** : 1.0.0  
**Date** : 5 octobre 2025  
**Auteur** : Philippe Hubert  
**Plateforme** : M5Stack AtomS3 (ESP32-S3)

---

*Pour toute question, consultez la documentation compl√®te ou ouvrez une issue sur GitHub.* üöÄ